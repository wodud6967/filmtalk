<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영화 상세보기</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/header.css">
    <style>
        #main {
            width: 100%;
            background-color: aliceblue;
            margin-top: 20px;
        }

        .inner {
            width: 1000px;
            margin: 0 auto;
        }

        #sec1 {
            color: black;
            background-color: aquamarine;
            /*height: 400px;*/
        }

        #sec2 {
            color: black;
            background-color: bisque;
            height: 400px;
        }

        .movie-detail__container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .movie-detail__poster {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .movie-detail__header {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .movie-detail__poster-container {
            flex: 1;
        }

        .movie-detail__details-container {
            flex: 2;
            margin-top: 50px;
        }

        .movie-detail__details-container h1 {
            margin-top: 20px;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .movie-detail__details-container .subdetails {
            margin-bottom: 15px;
            color: #555;
        }

        .movie-detail__details-container .subdetails div {
            display: inline-block;
            margin-right: 10px;
        }

        .movie-detail__details-container .subdetails div::before {
            content: "| ";
            color: #ccc;
        }

        .movie-detail__details-container .subdetails div:first-child::before {
            content: "";
            margin-right: 0;
        }

        .movie-detail__details-container .actions {
            margin-top: 20px;
        }

        .movie-detail__details-container .actions button {
            margin-right: 10px;
        }

        .nav-tabs {
            border-bottom: 2px solid #ddd;
        }

        .nav-tabs .nav-link.active {
            border-color: #007bff #007bff #fff;
            color: #007bff;
        }

        .movie-detail__main-section {
            margin-top: 20px;
        }

        .movie-detail__trailer-section,
        .movie-detail__stillcut-section {
            margin-top: 30px;
        }

        .movie-detail__trailer-section h5,
        .movie-detail__stillcut-section h5 {
            margin-bottom: 20px;
            font-weight: bold;
        }

        .movie-detail__trailer-section .trailer-grid,
        .movie-detail__stillcut-section .stillcut-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 10px;
        }

        .movie-detail__trailer-section .trailer-grid img,
        .movie-detail__stillcut-section .stillcut-grid img {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .movie-detail__review-section {
            margin-top: 30px;
        }

        .movie-detail__review-section h5 {
            font-weight: bold;
            margin-bottom: 20px;
        }

        .movie-detail__review {
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
        }

        .movie-detail__review .review-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            color: #555;
        }

        .movie-detail__review .review-content {
            color: #333;
        }
    </style>
</head>
<body>

{{>layout/header}}

<!-- 메인에서 작업하면되 1200px 중앙정렬-->
<main id="main">
    <section id="sec1" class="inner">
        <div class="movie-detail__container">
            <div class="movie-detail__header">
                <div class="movie-detail__poster-container">
                    <img src="{{model.posterUrl}}"
                         alt="Movie Poster" class="movie-detail__poster">
                </div>
                <div class="movie-detail__details-container">
                    <h1>{{model.movieNm}}</h1>
                    <div class="subdetails">
                        <div>개봉일: {{model.openDt}}</div>
                        <div>러닝타임: {{model.runtime}}분</div>
                        <div>관람등급: {{model.ratingGrade}}</div>
                    </div>
                    <div class="actions">
                        <button id="showModalBtn" type="button"  class="btn btn-primary">예고편 재생</button>
                        <button class="btn btn-secondary">공유</button>
                        <button class="btn btn-danger">예매하기</button>
                    </div>
                    <div class="mt-3">
                        <h5>영화 줄거리</h5>
                        <p>{{model.plot}}</p>
                    </div>
                </div>
            </div>

            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="detail-tab" data-bs-toggle="tab"
                            data-bs-target="#detail-tab-pane"
                            type="button" role="tab" aria-controls="detail-tab-pane" aria-selected="true">상세보기
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="review-tab" data-bs-toggle="tab" data-bs-target="#review-tab-pane"
                            type="button" role="tab" aria-controls="review-tab-pane" aria-selected="false">리뷰
                    </button>
                </li>
            </ul>

            <div class="tab-content movie-detail__main-section" id="myTabContent">
                <!-- 상세보기 탭 -->
                <div class="tab-pane fade show active" id="detail-tab-pane" role="tabpanel" aria-labelledby="detail-tab"
                     tabindex="0">
                    <article class="main__article">
                        <table class="table main__article__table table-borderless">
                            <tbody>
                            <tr>
                                <td colspan="2" class="fw-bold">영화정보</td>
                            </tr>
                            <tr>
                                <td>장르</td>
                                <td>{{model.genreNm}}</td>
                            </tr>
                            <tr>
                                <td>감독</td>
                                <td>{{model.director}}</td>
                            </tr>
                            <tr>
                                <td>출연</td>
                                <td>{{model.actorNm}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </article>
                    <div class="movie-detail__stillcut-section">
                        <h5>스틸컷</h5>
                        <div class="stillcut-grid">
                            {{#model.stillUrls}}
                                <img src="{{url}}"
                                     alt="스틸컷 이미지">
                            {{/model.stillUrls}}
                        </div>
                    </div>
                </div>

                <!-- 리뷰 탭 -->
                <div class="tab-pane fade" id="review-tab-pane" role="tabpanel" aria-labelledby="review-tab"
                     tabindex="0">
                    <div class="movie-detail__review-section">
                        <h5>리뷰</h5>
                        {{#model.comments}}
                            <div class="movie-detail__review">
                                <div class="review-details">
                                    <span>{{username}}</span>
                                    <span>{{createdAt}}</span>
                                </div>
                                <div class="review-content">
                                    {{content}}
                                </div>
                            </div>
                        {{/model.comments}}
                        <!-- 추가 리뷰 항목 -->
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<script>
    $('#showModalBtn').on('click', function() {
        // 동적으로 모달을 생성
        $('body').append(`
          <div class="modal fade" id="videoModal" tabindex="-1" role="dialog" aria-labelledby="videoModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-body">
                  <iframe id="videoPlayer" width="900" height="600" src="{{model.vodUrl}}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
          </div>
        `);

        // 모달을 표시
        $('#videoModal').modal('show');

        // 모달이 닫힐 때 삭제
        $('#videoModal').on('hidden.bs.modal', function () {
            $(this).remove();
        });
    });
</script>

{{>layout/footer}}
