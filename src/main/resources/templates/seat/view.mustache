<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>title</title> <!-- 좌석 선택 -->
    <!-- 부트스트랩 CSS 링크 -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/seat.css">
    <link rel="stylesheet" href="/css/header.css">

</head>

<body>

{{>layout/header}}

<main>
    <div id="hidden-data" data-price="{{model.price}}" data-showtimeid="{{showtimeId}}"></div>

    <div class="container mt-5">
        <!-- 상단 인원 / 좌석 -->
        <div class="text-center mb-4">
            <div class="bg-dark text-white py-2 mb-3">인원 / 좌석</div>
        </div>
        <section>
            <div class="count__seat__section">
                <!-- 인원 선택 -->
                <div class="count__section">
                    <div class="mb-4">
                        <div class="text-center">
                            <label>일반</label>
                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                <button class="btn btn-outline-primary" id="count0" value="0"
                                        onclick="getCount(this.value)">0
                                </button><!-- 0 클릭 시 초기화 -->
                                <button class="btn btn-outline-primary" id="count1" value="1"
                                        onclick="getCount(this.value)">1
                                </button>
                                <button class="btn btn-outline-primary" id="count2" value="2"
                                        onclick="getCount(this.value)">2
                                </button>
                                <button class="btn btn-outline-primary" id="count3" value="3"
                                        onclick="getCount(this.value)">3
                                </button>
                                <button class="btn btn-outline-primary" id="count4" value="4"
                                        onclick="getCount(this.value)">4
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="vertical__line"></div>
                <div class="movie__info__section">

                    <!-- 상영 정보 -->
                    <div class="text-center mb-4">
                        <img class="screen__img" src="img/cinema01.jpg"><!-- model.cinema 이미지로 수정 -->
                        <p class="font-weight-bold">{{model.cinemaNm}} | {{model.screenNm}} | 남은좌석 {{model.remainingSeats}}/{{model.totalSeats}}</p>
                        <p>{{model.wholeShowTime}} ~ {{model.endedAt}}</p><!-- 2024.09.04 (수) 20:15 -->
                    </div>
                </div>
            </div>

        </section>


        <!-- 좌석 배치 -->
        <div class="seat-selection text-center mb-4">
            <div class="bg-dark text-white py-2 mb-3">SCREEN</div>
            <div id="seat-container"></div>
            <!-- 좌석 반복 추가 -->
        </div>
    </div>

    <!-- 하단 검은창 -->
    <div class="row bg-dark text-white py-2 mb-3">
        <div class="col text-left">
            <button class="btn btn-secondary">영화선택</button>
        </div>
        <div class="blackbox__middle__container">
            <div class="blackbox__img__div">
                <img class="movie__img" src="{{model.posterUrl}}">
            </div>
            <div class="blackbox__movie__div">
                <div>{{model.movieNm}}</div>
                <div>{{model.ratingGrade}}</div>
            </div>
            <div>
                <table>
                    <tr>
                        <td class="left__td">극장</td>
                        <td class="right__td">{{model.cinemaNm}}</td>
                    </tr>
                    <tr>
                        <td>일시</td>
                        <td>{{model.wholeShowTime}}</td><!-- 2024.9.14(토) 12:00 -->
                    </tr>
                    <tr>
                        <td>상영관</td>
                        <td>{{model.screenNm}}</td>
                    </tr>
                    <tr>
                        <td>인원</td>
                        <td id="peopleNum"></td><!-- js로 -->
                    </tr>
                </table>
            </div>
            <div class="seat__num__box" id="seatNumBox">
                <!-- JS 로 동적으로 넣기 -->
                <table>
                    <tr>
                        <td>좌석번호</td>
                        <td id="seatNumbers">E9, E10</td>
                    </tr>
                </table>
            </div>
            <div class="seat__payment__box" id="paymentBox">
                <!-- JS 로 동적으로 넣기 -->
                <table>
                    <tr>
                        <td>일반</td>
                        <td id="ticketPrice">20,000원 * 2</td> <!-- 신민재 추가 -->
                    </tr>
                    <tr>
                        <td>총금액</td>
                        <td id="totalPrice">40,000원</td><!-- 신민재 추가 -->
                    </tr>

                </table>
            </div>
        </div>

        <!-- 신민재 form 추가 -->
        <div class="col text-right">
            <form action="/pay/view" method="POST" id="paymentForm">
                <input type="hidden" name="reservationId" id="reservationId" value="1"> <!-- 실제 reservationId로 설정 -->
                <input type="hidden" name="sTotalPrice" id="sTotalPrice" value="">

                <button type="submit" class="btn btn-secondary" onclick="submitForm()">결제선택</button>
            </form>
            <form action="/seat/reservation" method="post">
                <!--                <input type="hidden" name="showtimeId" value="">-->
                <input type="hidden" name="showtimeId" value="{{showtimeId}}">
                <input type="hidden" name="selectedSeatsIds" id="selectedSeatsIds">
                <input type="hidden" name="totalPrice" id="totalPrice">
                <button onclick="return didYouSelectAll()" class="btn btn-secondary" type="submit">결제선택</button>
            </form>
        </div>
    </div>

    <!-- 부트스트랩 JS 및 jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="js/seat.js"></script>

    <script> // 좌석 및 금액 설정 TODO: 신민재: 결제 테스트를 위해 추가
        function submitForm() {
            const selectedSeats = ['E9', 'E10']; // 선택된 좌석 (동적으로 설정 가능)
            const ticketPrice = 20000; // 티켓 가격
            const totalPrice = selectedSeats.length * ticketPrice; // 총 금액 계산

            // 좌석 및 가격 정보를 form에 설정
            document.getElementById('reservationId').value = 1; // 실제 reservationId로 설정
            document.getElementById('sTotalPrice').value = totalPrice;

            // form을 전송할 때 추가로 console.log()로 값 확인
            console.log("reservationId: " + document.getElementById('reservationId').value);
            console.log("sTotalPrice: " + document.getElementById('sTotalPrice').value);

            document.getElementById('paymentForm').submit(); // form 제출
        }
    </script>

    <script src="js/seat2.js"></script>
</main>

{{>layout/footer}}

</body>

</html>